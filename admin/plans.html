<!DOCTYPE html>
<html lang="en" dir="ltr" data-nav-layout="vertical" data-theme-mode="light" data-header-styles="transparent" data-width="fullwidth" data-menu-styles="transparent" data-page-style="flat" data-toggled="close">

<head>
    <meta charset="UTF-8">
    <meta name='viewport' content='width=device-width, initial-scale=1.0'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>BizVisibility AI - Manage Plans</title>
    <link rel="icon" href="../assets/images/brand-logos/favicon.ico" type="image/x-icon">
    <script src="../assets/libs/choices.js/public/assets/scripts/choices.min.js"></script>
    <script src="../assets/js/main.js"></script>
    <link id="style" href="../assets/libs/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="../assets/css/styles.css" rel="stylesheet">
    <link href="../assets/css/icons.css" rel="stylesheet">
    <link href="../assets/libs/node-waves/waves.min.css" rel="stylesheet">
    <link href="../assets/libs/simplebar/simplebar.min.css" rel="stylesheet">
</head>

<body>
    <div class="page">
        <!-- Header -->
        <header class="app-header sticky">
            <div class="main-header-container container-fluid">
                <div class="header-content-left">
                    <div class="header-element">
                        <div class="horizontal-logo">
                            <a href="dashboard.html" class="header-logo">
                                <img src="../assets/images/brand-logos/desktop-logo.png" alt="logo" class="desktop-logo">
                                <img src="../assets/images/brand-logos/desktop-dark.png" alt="logo" class="desktop-dark">
                            </a>
                        </div>
                    </div>
                    <div class="header-element">
                        <a aria-label="Hide Sidebar" class="sidemenu-toggle header-link animated-arrow hor-toggle horizontal-navtoggle" data-bs-toggle="sidebar" href="javascript:void(0);"><span></span></a>
                    </div>
                </div>
                
                <ul class="header-content-right">
                    <li class="header-element header-theme-mode">
                        <a href="javascript:void(0);" class="header-link layout-setting">
                            <span class="light-layout">
                                <svg xmlns="http://www.w3.org/2000/svg" class="header-link-icon" viewBox="0 0 256 256"><rect width="256" height="256" fill="none"/><path d="M108.11,28.11A96.09,96.09,0,0,0,227.89,147.89,96,96,0,1,1,108.11,28.11Z" opacity="0.2"/><path d="M108.11,28.11A96.09,96.09,0,0,0,227.89,147.89,96,96,0,1,1,108.11,28.11Z" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/></svg>
                            </span>
                            <span class="dark-layout">
                                <svg xmlns="http://www.w3.org/2000/svg" class="header-link-icon" viewBox="0 0 256 256"><rect width="256" height="256" fill="none"/><circle cx="128" cy="128" r="56" opacity="0.2"/><line x1="128" y1="40" x2="128" y2="32" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/><circle cx="128" cy="128" r="56" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/><line x1="64" y1="64" x2="56" y2="56" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/><line x1="64" y1="192" x2="56" y2="200" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/><line x1="192" y1="64" x2="200" y2="56" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/><line x1="192" y1="192" x2="200" y2="200" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/><line x1="40" y1="128" x2="32" y2="128" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/><line x1="128" y1="216" x2="128" y2="224" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/><line x1="216" y1="128" x2="224" y2="128" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/></svg>
                            </span>
                        </a>
                    </li>
                    <li class="header-element dropdown">
                        <a href="javascript:void(0);" class="header-link dropdown-toggle" id="mainHeaderProfile" data-bs-toggle="dropdown" data-bs-auto-close="outside">
                            <div>
                                <img src="../assets/images/faces/12.jpg" alt="img" class="header-link-icon">
                            </div>
                        </a>
                        <div class="main-header-dropdown dropdown-menu pt-0 overflow-hidden header-profile-dropdown dropdown-menu-end" aria-labelledby="mainHeaderProfile">
                            <div class="p-3 bg-primary text-fixed-white">
                                <p class="mb-0 fs-16">Admin Profile</p>
                            </div>
                            <div class="dropdown-divider"></div>
                            <ul class="list-unstyled mb-0">
                                <li>
                                    <a class="dropdown-item d-flex align-items-center" href="profile-settings.html"><i class="ri-settings-gear-line me-2"></i>Admin Settings</a>
                                </li>
                                <li>
                                    <a class="dropdown-item d-flex align-items-center" href="../login.html"><i class="ri-logout-box-line me-2"></i>Log Out</a>
                                </li>
                            </ul>
                        </div>
                    </li>
                </ul>
            </div>
        </header>
        
        <!-- Sidebar -->
        <aside class="app-sidebar sticky" id="sidebar">
            <div class="main-sidebar-header">
                <a href="dashboard.html" class="header-logo">
                    <img src="../assets/images/brand-logos/desktop-logo.png" alt="logo" class="desktop-logo">
                    <img src="../assets/images/brand-logos/desktop-dark.png" alt="logo" class="desktop-dark">
                </a>
            </div>
            
            <div class="main-sidebar has-footer" id="sidebar-scroll">
                <nav class="main-menu-container nav nav-pills flex-column sub-open">
                    <ul class="main-menu">
                        <li class="slide">
                            <a href="dashboard.html" class="side-menu__item">
                                <svg xmlns="http://www.w3.org/2000/svg" class="side-menu__icon" viewBox="0 0 256 256"><rect width="256" height="256" fill="none"/><path d="M133.66,34.34a8,8,0,0,0-11.32,0L40,116.69V216h64V152h48v64h64V116.69Z" opacity="0.2"/><line x1="16" y1="216" x2="240" y2="216" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/><polyline points="152 216 152 152 104 152 104 216" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/><line x1="40" y1="116.69" x2="40" y2="216" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/><line x1="216" y1="216" x2="216" y2="116.69" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/><path d="M24,132.69l98.34-98.35a8,8,0,0,1,11.32,0L232,132.69" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/></svg>
                                <span class="side-menu__label">Dashboard</span>
                            </a>
                        </li>
                        <li class="slide">
                            <a href="users.html" class="side-menu__item">
                                <svg xmlns="http://www.w3.org/2000/svg" class="side-menu__icon" viewBox="0 0 256 256"><rect width="256" height="256" fill="none"/><circle cx="88" cy="104" r="40" opacity="0.2"/><circle cx="88" cy="104" r="40" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/><path d="M16,216a64,64,0,0,1,144,0" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/><circle cx="168" cy="120" r="32" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/><path d="M131.37,203a56,56,0,0,1,89.26,0" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/></svg>
                                <span class="side-menu__label">Users & Businesses</span>
                            </a>
                        </li>
                        <li class="slide">
                            <a href="plans.html" class="side-menu__item">
                                <svg xmlns="http://www.w3.org/2000/svg" class="side-menu__icon" viewBox="0 0 256 256"><rect width="256" height="256" fill="none"/><path d="M48,120h160V80a8,8,0,0,0-8-8H56a8,8,0,0,0-8,8Z" opacity="0.2"/><rect x="48" y="72" width="160" height="112" rx="8" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/><path d="M80,184v16a8,8,0,0,1-8,8H64a8,8,0,0,1-8-8v-16" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/><path d="M176,184v16a8,8,0,0,0,8,8h8a8,8,0,0,0,8-8v-16" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/><line x1="96" y1="120" x2="96" y2="168" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/><line x1="160" y1="120" x2="160" y2="168" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/></svg>
                                <span class="side-menu__label">Plans</span>
                            </a>
                        </li>
                        <li class="slide">
                            <a href="api-keys.html" class="side-menu__item">
                                <svg xmlns="http://www.w3.org/2000/svg" class="side-menu__icon" viewBox="0 0 256 256"><rect width="256" height="256" fill="none"/><path d="M216,56H40A16,16,0,0,0,24,72V184a16,16,0,0,0,16,16H216a16,16,0,0,0,16-16V72A16,16,0,0,0,216,56Zm0,128H40V72H216v112Z" opacity="0.2"/><rect x="40" y="56" width="176" height="128" rx="8" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/><circle cx="120" cy="120" r="16" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/><path d="M80,120a40,40,0,0,1,80,0" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/></svg>
                                <span class="side-menu__label">API Keys</span>
                            </a>
                        </li>
                    </ul>
                </nav>
            </div>
        </aside>
        
        <!-- Main Content -->
        <div class="main-content app-content">
            <div class="container-fluid page-container">
                <div class="d-flex align-items-center justify-content-between mb-4">
                    <div>
                        <h1 class="page-title fw-bold mb-0">Manage Plans</h1>
                        <p class="text-muted">View, edit, and manage subscription plans</p>
                    </div>
                    <button class="btn btn-primary" onclick="showAddPlanModal()"><i class="ri-add-line"></i> Add New Plan</button>
                </div>

                <!-- Plans Table -->
                <div class="card custom-card">
                    <div class="card-header">
                        <div class="input-group">
                            <span class="input-group-text"><i class="ri-search-line"></i></span>
                            <input type="text" class="form-control" id="searchPlans" placeholder="Search plans by name...">
                        </div>
                    </div>
                    <div class="card-body p-0">
                        <div class="table-responsive">
                            <table class="table table-hover mb-0">
                                <thead>
                                    <tr>
                                        <th>Plan Name</th>
                                        <th>Description</th>
                                        <th>Price/Month</th>
                                        <th>Annual Price</th>
                                        <th>Features</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="plansTableBody">
                                    <!-- Plans will be populated by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add/Edit Plan Modal -->
    <div class="modal fade" id="planModal" tabindex="-1" aria-labelledby="planModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
                <div class="modal-header border-bottom">
                    <h5 class="modal-title" id="planModalLabel">Add New Plan</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="planForm">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="planName" class="form-label">Plan Name</label>
                                <input type="text" class="form-control" id="planName" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="planStatus" class="form-label">Status</label>
                                <select class="form-control" id="planStatus" required>
                                    <option value="Active">Active</option>
                                    <option value="Inactive">Inactive</option>
                                </select>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label for="planDescription" class="form-label">Description</label>
                            <textarea class="form-control" id="planDescription" rows="3" placeholder="Plan description..."></textarea>
                        </div>

                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="planMonthlyPrice" class="form-label">Monthly Price ($)</label>
                                <input type="number" class="form-control" id="planMonthlyPrice" step="0.01" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="planAnnualPrice" class="form-label">Annual Price ($)</label>
                                <input type="number" class="form-control" id="planAnnualPrice" step="0.01" required>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label for="planFeatures" class="form-label">Features (comma-separated)</label>
                            <textarea class="form-control" id="planFeatures" rows="3" placeholder="e.g., Up to 5 audits, Priority support, Custom reports"></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="savePlan()">Save Plan</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS Bundle -->
    <script src="../assets/libs/bootstrap/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // Sample plans data
        let plans = {
            1: {
                id: 1,
                name: "Free",
                description: "Perfect for getting started",
                monthlyPrice: 0,
                annualPrice: 0,
                features: ["Up to 2 audits", "Basic reports", "Email support"],
                status: "Active"
            },
            2: {
                id: 2,
                name: "Standard",
                description: "Great for small businesses",
                monthlyPrice: 29.99,
                annualPrice: 299.90,
                features: ["Up to 10 audits", "Detailed reports", "Priority support", "Custom branding"],
                status: "Active"
            },
            3: {
                id: 3,
                name: "Premium",
                description: "For growing businesses",
                monthlyPrice: 99.99,
                annualPrice: 999.90,
                features: ["Unlimited audits", "Advanced analytics", "24/7 support", "API access", "Custom reports", "Team collaboration"],
                status: "Active"
            }
        };

        let currentEditId = null;
        let nextPlanId = 4;

        function loadPlans() {
            const tableBody = document.getElementById('plansTableBody');
            tableBody.innerHTML = '';

            Object.values(plans).forEach(plan => {
                const featuresList = Array.isArray(plan.features) ? plan.features.join(', ') : plan.features;
                const statusBadge = plan.status === 'Active' ? '<span class="badge bg-success">Active</span>' : '<span class="badge bg-secondary">Inactive</span>';

                tableBody.innerHTML += `
                    <tr>
                        <td><strong>${plan.name}</strong></td>
                        <td>${plan.description}</td>
                        <td>$${plan.monthlyPrice.toFixed(2)}</td>
                        <td>$${plan.annualPrice.toFixed(2)}</td>
                        <td>
                            <small>${featuresList.substring(0, 50)}${featuresList.length > 50 ? '...' : ''}</small>
                        </td>
                        <td>${statusBadge}</td>
                        <td>
                            <button class="btn btn-sm btn-outline-primary" onclick="editPlan(${plan.id})"><i class="ri-edit-line"></i> Edit</button>
                            <button class="btn btn-sm btn-outline-danger" onclick="deletePlan(${plan.id})"><i class="ri-delete-line"></i> Delete</button>
                        </td>
                    </tr>
                `;
            });
        }

        function showAddPlanModal() {
            currentEditId = null;
            document.getElementById('planForm').reset();
            document.getElementById('planModalLabel').textContent = 'Add New Plan';
            new bootstrap.Modal(document.getElementById('planModal')).show();
        }

        function editPlan(planId) {
            currentEditId = planId;
            const plan = plans[planId];

            if (plan) {
                document.getElementById('planName').value = plan.name;
                document.getElementById('planDescription').value = plan.description;
                document.getElementById('planMonthlyPrice').value = plan.monthlyPrice;
                document.getElementById('planAnnualPrice').value = plan.annualPrice;
                document.getElementById('planStatus').value = plan.status;
                document.getElementById('planFeatures').value = Array.isArray(plan.features) ? plan.features.join(', ') : plan.features;

                document.getElementById('planModalLabel').textContent = 'Edit Plan';
                new bootstrap.Modal(document.getElementById('planModal')).show();
            }
        }

        function savePlan() {
            const name = document.getElementById('planName').value;
            const description = document.getElementById('planDescription').value;
            const monthlyPrice = parseFloat(document.getElementById('planMonthlyPrice').value);
            const annualPrice = parseFloat(document.getElementById('planAnnualPrice').value);
            const status = document.getElementById('planStatus').value;
            const featuresInput = document.getElementById('planFeatures').value;
            const features = featuresInput.split(',').map(f => f.trim()).filter(f => f !== '');

            if (!name || isNaN(monthlyPrice) || isNaN(annualPrice)) {
                alert('Please fill in all required fields');
                return;
            }

            if (currentEditId) {
                // Update existing plan
                plans[currentEditId] = {
                    id: currentEditId,
                    name,
                    description,
                    monthlyPrice,
                    annualPrice,
                    features,
                    status
                };
                alert('Plan updated successfully!');
            } else {
                // Create new plan
                plans[nextPlanId] = {
                    id: nextPlanId,
                    name,
                    description,
                    monthlyPrice,
                    annualPrice,
                    features,
                    status
                };
                nextPlanId++;
                alert('Plan created successfully!');
            }

            loadPlans();
            bootstrap.Modal.getInstance(document.getElementById('planModal')).hide();
        }

        function deletePlan(planId) {
            if (confirm('Are you sure you want to delete this plan?')) {
                delete plans[planId];
                loadPlans();
                alert('Plan deleted successfully!');
            }
        }

        // Search functionality
        document.getElementById('searchPlans').addEventListener('keyup', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            const rows = document.querySelectorAll('#plansTableBody tr');
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        });

        // Theme mode toggle
        document.querySelector('.layout-setting').addEventListener('click', function(e) {
            e.preventDefault();
            const html = document.documentElement;
            const currentMode = html.getAttribute('data-theme-mode');
            const newMode = currentMode === 'light' ? 'dark' : 'light';
            html.setAttribute('data-theme-mode', newMode);
            localStorage.setItem('themeMode', newMode);
        });

        // Initialize theme from localStorage
        const savedTheme = localStorage.getItem('themeMode') || 'light';
        document.documentElement.setAttribute('data-theme-mode', savedTheme);

        // Load plans on page load
        loadPlans();
    </script>
</body>

</html>
